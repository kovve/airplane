var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Model;!function(e){var t=function(){function e(){}return e.isNotFirstLogin=!1,e.version=201801251304,e.score=0,e.isInAPP=!1,e.userID="1000308962M4GU",e.appID=1,e.postJosn={domain:"",appId:0,sort:0},e}();e.GlobalData=t,__reflect(t.prototype,"Model.GlobalData")}(Model||(Model={}));var Manager;!function(e){var t=egret.getDefinitionByName,n=function(){function e(){this.maps={}}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.openModule=function(e,n){void 0===n&&(n=null),console.log("打开模块："+e);var i;if(this.maps.hasOwnProperty(e))i=this.maps[e];else{var o=t(e);i=new o,this.maps[e]=i}n&&i.init(n),i.show()},e.prototype.hideModel=function(e){void 0===e&&(e="");var t=this.maps[e];t&&t.hide(),console.log("hide模块："+e)},e.prototype.destoryModule=function(e){void 0===e&&(e="");var t=this.maps[e];t&&(t.dispose(),t=null,delete this.maps[e]),console.log("关闭模块："+e)},e.prototype.isContain=function(e){return this.maps.hasOwnProperty(e)?!0:!1},e.prototype.destoryAll=function(){var e;for(e in this.maps)this.destoryModule(e);this.maps={}},e.prototype.destroyForInstance=function(e){var t=egret.getQualifiedClassName(e);this.destoryModule(t)},e.prototype.traceMap=function(){var e;for(e in this.maps)console.log(e)},e}();e.ModuleManager=n,__reflect(n.prototype,"Manager.ModuleManager")}(Manager||(Manager={}));var config;!function(e){var t=function(){function e(){}return e.paserJosn=function(e){this.appName=e.appName,this.bgMusic=e.bgMusic,this.bgImage=e.bgImage,this.adSlogan=e.adSlogan,this.appExplain=e.appExplain,this.awardExplain=e.awardExplain,this.gameIntro=e.gameIntro,this.startTime=e.startTime,this.endTime=e.endTime,this.thumb=e.thumb,this.beginMessage=e.beginMessage,this.endMessage=e.endMessage,this.downloadUrl=e.downloadUrl,this.setGameContend(e.blockContent)},e.setGameContend=function(e){this.myBulletSpeed=parseInt(e.myBulletSpeed)||12,this.myBulletHurt=parseInt(e.myBulletHurt)||2,this.enemyBulletSpeed=parseInt(e.enemyBulletSpeed)||8,this.enemyBulletHurt=parseInt(e.enemyBulletHurt)||1,this.myPlaneBlood=parseInt(e.myPlaneBlood)||12,this.enmeyPanelBlood=parseInt(e.enmeyPanelBlood)||10,this.hitHurt=parseInt(e.hitHurt)||12},e.gameId=3,e.noInAppNotic="下载并登录官方APP参加趣味游戏，可参与好友排行，还有丰厚奖励等你拿哦！",e}();e.GameConfig=t,__reflect(t.prototype,"config.GameConfig")}(config||(config={}));var Model;!function(e){var t=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.localRankList=function(e){this.localSortList=e,this.localSortList.length>1&&this.localSortList.sort(this.compare),this.localGet=!0},e.prototype.nationRankList=function(e){this.nationSortList=e,this.nationSortList.length>1&&this.nationSortList.sort(this.compare),this.nationGet=!0},e.prototype.compare=function(e,t){var n=parseInt(e.userScore),i=parseInt(t.userScore);return n>i?-1:i>n?1:0},e}();e.RankData=t,__reflect(t.prototype,"Model.RankData")}(Model||(Model={}));var Manager;!function(e){var t=function(){function e(){this._scaleY=1,this._scaleX=1}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(e){if(this.Mstage=e,!egret.Capabilities.isMobile)return void(this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL);console.log("当前渲染模式："+egret.Capabilities.renderMode),console.log("边界"+egret.Capabilities.boundingClientWidth+"*"+egret.Capabilities.boundingClientHeight);var t=egret.Capabilities.boundingClientWidth,n=egret.Capabilities.boundingClientHeight,i=t/n,o=720,r=1280;o/r>i?this.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT:this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH,this._scaleX=this.stage.stageWidth/o,this._scaleY=this.stage.stageHeight/r,console.log("stageWidth"+this.stage.stageWidth+";stageHeight"+this.stage.stageHeight),console.log("scaleX:"+this._scaleX+";scaleY:"+this._scaleY)},Object.defineProperty(e.prototype,"stage",{get:function(){return this.Mstage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scaleX<this._scaleY?this._scaleX:this._scaleY},enumerable:!0,configurable:!0}),e.firstLevel=0,e.secondLevel=1,e.thirdLevel=2,e}();e.Layout=t,__reflect(t.prototype,"Manager.Layout")}(Manager||(Manager={}));var Manager;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.getInstance=function(){return null==this.instance&&(this.instance=new n),this.instance},n.prototype.startGame=function(){this._mapLevel=new egret.Sprite,this._gameLvel=new eui.Group,this._appLevel=new eui.Group,this._topLevel=new eui.Group,this._loadLevel=new eui.Group,this._appLevel.width=e.Layout.getInstance().stage.stageWidth,this._appLevel.height=e.Layout.getInstance().stage.stageHeight,this._appLevel.touchEnabled=!1,this._appLevel.layout=new eui.BasicLayout,e.Layout.getInstance().stage.addChild(this._mapLevel),e.Layout.getInstance().stage.addChild(this._gameLvel),e.Layout.getInstance().stage.addChild(this._appLevel),e.Layout.getInstance().stage.addChild(this._topLevel),e.Layout.getInstance().stage.addChild(this._loadLevel)},Object.defineProperty(n.prototype,"appLevel",{get:function(){return this._appLevel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mapLevel",{get:function(){return this._mapLevel},enumerable:!0,configurable:!0}),n}(egret.EventDispatcher);e.UIManager=t,__reflect(t.prototype,"Manager.UIManager")}(Manager||(Manager={}));var utils;!function(e){var t=function(){function e(){}return e.setCenter=function(e){e.x=(Layout.getInstance().stage.stageWidth-e.width)/2,e.y=(Layout.getInstance().stage.stageHeight-e.height)/2},e.getShape=function(e,t,n,i){void 0===e&&(e=640),void 0===t&&(t=960),void 0===n&&(n=0),void 0===i&&(i=.7);var o=new egret.Sprite,r=new egret.Shape;return r.graphics.beginFill(n,i),r.graphics.drawRect(0,0,e,t),r.graphics.endFill(),r.touchEnabled=!1,o.addChild(r),o},e.getArtNum=function(e,t){for(var n=new egret.Sprite,i=0;i<t.length;){var o=RES.getRes(e+t.charAt(i)),r=new egret.Bitmap(o);r.x=n.width+1,r.y=-o.textureHeight/2,n.addChild(r)}return n},e.hitTest=function(e,t){var n=e.getBounds(),i=t.getBounds();return n.x=e.x,n.y=e.y,i.x=t.x,i.y=t.y,n.intersects(i)},e}();e.ViewUtil=t,__reflect(t.prototype,"utils.ViewUtil")}(utils||(utils={}));var component;!function(e){var t=Manager.Layout,n=Manager.UIManager,i=Manager.ModuleManager,o=utils.ViewUtil,r=function(e){function r(){var t=e.call(this)||this;return t.addBlackBg=!0,t.fullScreen=!1,t.verticalCenter=t.horizontalCenter=0,t}return __extends(r,e),r.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},r.prototype.init=function(e){void 0===e&&(e=null)},r.prototype.show=function(){this.addBlackBg&&this.addBg(),this.fullScreen&&(this.width=t.getInstance().stage.stageWidth,this.height=t.getInstance().stage.stageHeight),n.getInstance().appLevel.addChild(this)},r.prototype.addBg=function(){this.bg=o.getShape(t.getInstance().stage.stageWidth,t.getInstance().stage.stageHeight,0,.5),n.getInstance().appLevel.addChild(this.bg),this.bg.touchEnabled=!0},r.prototype.hide=function(){i.getInstance().destroyForInstance(this)},r.prototype.dispose=function(){n.getInstance().appLevel.removeChild(this),this.bg&&this.bg.parent&&this.bg.parent.removeChild(this.bg),this.bg=null},r}(eui.Component);e.BaseView=r,__reflect(r.prototype,"component.BaseView")}(component||(component={}));var Manager;!function(e){var t=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new egret.EventDispatcher),this.instance},e.addEventListener=function(e,t,n,i,o){void 0===i&&(i=!1),void 0===o&&(o=1),this.getInstance().addEventListener(e,t,n,i,o)},e.removeEventListener=function(e,t,n,i){void 0===i&&(i=!1),this.getInstance().removeEventListener(e,t,n,i)},e.dispatchEvent=function(e){this.getInstance().dispatchEvent(e)},e}();e.EventManager=t,__reflect(t.prototype,"Manager.EventManager")}(Manager||(Manager={}));var proxy;!function(e){var t=config.GameConfig,n=Model.GlobalData,i=Model.RankData,o=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.getGameConfig=function(i){void 0===i&&(i=1);var o="http://"+n.gameDomainURL+"/index.php?m=content&c=litAppBlock&a=index&mobileDomain="+n.gameDomainURL+"&gameID="+t.gameId+"&requstID="+e.GameConfigID;console.log("curURL:"+o),this.postRequset(o)},e.prototype.reportResult=function(i,o,r){void 0===r&&(r=0);var s="http://"+n.gameDomainURL+"/index.php?m=content&c=acceptResult&a=add&domain="+n.gameDomainURL+"&userId="+i+"&appId="+t.gameId+"&score="+o+"&bonus="+r+"&requstID="+e.reportResultID;this.postRequset(s)},e.prototype.getRankList=function(i){void 0===i&&(i=0);var o="http://"+n.gameDomainURL+"/index.php?m=content&c=userRankingList&a=showList&domain="+n.gameDomainURL+"&appId="+t.gameId+"&sort="+i+"&requstID="+e.rankInfoID;console.log(o),this.postRequset(o)},e.prototype.getUserRank=function(i){var o="http://"+n.gameDomainURL+"/index.php?m=content&c=currentUserNumber&a=showIndex&userId="+i+"&gameId="+t.gameId+"&requstID="+e.userRank;console.log(o),this.postRequset(o)},e.prototype.postRequset=function(e){var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open(e,egret.HttpMethod.POST),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(n){var o=n.currentTarget;this.removeEvent(o);var r=JSON.parse(o.response);if(parseInt(r.StatusCode)>0){var s=r.retData,a=parseInt(s.requstID||s[0].requstID);switch(a){case e.GameConfigID:t.paserJosn(s[0]),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_INFO_SUCESS));break;case e.rankInfoID:if(s.length<=0)return void EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_RANK_SUCESS,0));1==parseInt(s[0].sort)?i.getInstance().localRankList(s):i.getInstance().nationRankList(s),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_RANK_SUCESS,parseInt(s[0].sort)));break;case e.reportResultID:console.log("上报成功！！"),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.UP_SOCRE_SUCESS));break;case e.userRank:s?EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_USERRANK_SUCESS,s)):alert("数据为空！")}}else alert(r.retMessage)},e.prototype.onGetIOError=function(e){console.log("postError:"+e),this.removeEvent(e.currentTarget)},e.prototype.onGetProgress=function(e){},e.prototype.removeEvent=function(e){e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.getString=function(e){return"0000"},e.GameConfigID=1,e.reportResultID=2,e.rankInfoID=3,e.userRank=4,e}();e.HttpCommand=o,__reflect(o.prototype,"proxy.HttpCommand")}(proxy||(proxy={}));var proxy;!function(proxy){var GlobalData=Model.GlobalData,PlayerInfoProxy=function(){function PlayerInfoProxy(){}return PlayerInfoProxy.getInstance=function(){return null==this.instance&&(this.instance=new PlayerInfoProxy),this.instance},PlayerInfoProxy.prototype.getMyInfo=function(){var u=navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1,isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);GlobalData.gameDomainURL=window.location.host,GlobalData.isIOS=isiOS;var uInfo,josnStr;if(window.location.href.indexOf("onapp")>-1){if(GlobalData.isInAPP=!0,isAndroid)try{josnStr=eval("android.getUserInfo()"),uInfo=eval("("+josnStr+")"),null!=uInfo&&uInfo.userLogin?this.getInfoSucess(uInfo):eval("android.goLogin()")}catch(error){console.log("调用失败"),this.getInfoFail()}else if(isiOS)try{josnStr=eval("OCModel.getUserInfo()"),uInfo=eval("("+josnStr+")"),null!=uInfo&&uInfo.userLogin?this.getInfoSucess(uInfo):eval("OCModel.getLogin()")}catch(error){console.log("调用失败"),this.getInfoFail()}}else console.log("非APP中"),GlobalData.isInAPP=!1,this.getInfoFail()},PlayerInfoProxy.prototype.getInfoSucess=function(e){e&&(GlobalData.isInAPP=!0,GlobalData.userName=e.userName,GlobalData.userImg=e.userImg,GlobalData.appID=parseInt(e.Appid),GlobalData.openId=parseInt(e.openid),GlobalData.unionid=parseInt(e.unionid),GlobalData.userID=e.userLogin,GlobalData.telephoneId=parseInt(e.userPhone),GlobalData.passId=parseInt(e.userPwd))},PlayerInfoProxy.prototype.getInfoFail=function(){},PlayerInfoProxy}();proxy.PlayerInfoProxy=PlayerInfoProxy,__reflect(PlayerInfoProxy.prototype,"proxy.PlayerInfoProxy")}(proxy||(proxy={}));var fighter;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t.graphics;return n.beginFill(0,.8),n.drawRect(0,0,400,200),n.endFill(),t.txt=new egret.TextField,t.txt.width=400,t.txt.height=200,t.txt.textAlign="center",t.txt.textColor=16777215,t.txt.size=24,t.txt.y=60,t.addChild(t.txt),t.touchChildren=!1,t.touchEnabled=!1,t}return __extends(t,e),t.prototype.showScore=function(e){var t="您的成绩是:\n"+e+"\n再来一次吧";this.txt.text=t},t}(egret.Sprite);e.ScorePanel=t,__reflect(t.prototype,"fighter.ScorePanel")}(fighter||(fighter={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function o(e){t.call(i,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?i(o):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ModuleManager=Manager.ModuleManager,Layout=Manager.Layout,EventManager=Manager.EventManager,PlayerInfoProxy=proxy.PlayerInfoProxy,HttpCommand=proxy.HttpCommand,GameConfig=config.GameConfig,Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},egret.ImageLoader.crossOrigin="anonymous",Layout.getInstance().init(this.stage);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),PlayerInfoProxy.getInstance().getMyInfo(),EventManager.addEventListener(Events.CommonEvent.GET_INFO_SUCESS,this.loadGameDataBack,this),HttpCommand.getInstance().getGameConfig(2)},t.prototype.loadGameDataBack=function(){var e=new RES.VersionController;e.getVirtualUrl=function(e){return e+"?v="+GlobalData.version},RES.registerVersionController(e),EventManager.removeEventListener(Events.CommonEvent.GET_INFO_SUCESS,this.loadGameDataBack,this),document.title=GameConfig.appName||"2048小游戏",RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){SoundManager.getIns().addItem("bgm_mp3",null,!0),SoundManager.getIns().play("bgm_mp3",0,0),Manager.UIManager.getInstance().startGame(),Manager.ModuleManager.getInstance().openModule("fighter.GameContainer")},t}(eui.UILayer);__reflect(Main.prototype,"Main");var SoundManager=function(e){function t(){var t=e.call(this)||this;return t.sounds={},t.channels={},t.volumeBg=1,t.volumeEffect=1,t.isNoVolume=1,t._activated=!0,Layout.getInstance().stage.addEventListener(egret.Event.ACTIVATE,t.stage_activateHandler,t),Layout.getInstance().stage.addEventListener(egret.Event.DEACTIVATE,t.stage_activateHandler,t),t}return __extends(t,e),t.getIns=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.stage_activateHandler=function(e){if(this._activated=e.type==egret.Event.ACTIVATE,this._activated){var t=parseInt(egret.localStorage.getItem("sound.bgVol"));console.log("bgVo:"+t+":"+egret.localStorage.getItem("sound.bgVol")),this.setBgVolume(t)}else egret.localStorage.setItem("sound.bgVol",""+this.volumeBg),this.setBgVolume(0)},t.prototype.checkSoundIsBg=function(e,t){return e[t+"-bg"]},t.prototype.addItem=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var i=e;n&&(i=e+"-bg"),t?this.sounds[i]=t:this.sounds[i]||(t=RES.getRes(e),this.sounds[i]=t)},t.prototype.addBgMusic=function(e){e.indexOf("http")>0?this.addItem(e,null,!0):this.loadBgSound(e)},t.prototype.play=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=1),null==this.sounds[e]&&this.addItem(e);var i=this.volumeEffect;if(this.checkSoundIsBg(this.sounds,e)&&(e+="-bg",i=this.volumeBg),this.sounds[e]){var o=this.sounds[e];this.channels[e]=o.play(t,n),0==this.isNoVolume?this.channels[e].volume=0:this.channels[e].volume=i}},t.prototype.stop=function(e){if(this.checkSoundIsBg(this.channels,e)&&(e+="-bg"),this.channels[e]){var t=this.channels[e];t.stop()}},t.prototype.setVolume=function(e,t){if(this.checkSoundIsBg(this.channels,e)&&(e+="-bg"),this.channels[e]){var n=this.channels[e];n.volume=t}},t.prototype.setBgVolume=function(e){for(var t in this.channels)if(2==t.split("-bg").length){var n=this.channels[t];this.volumeBg=e,0!=n.position&&(n.volume=e)}},t.prototype.setEffectVolume=function(e){for(var t in this.channels)if(1==t.split("-bg").length){var n=this.channels[t];this.volumeEffect=e,0!=n.position&&(n.volume=e)}},t.prototype.setIsNoVolume=function(e){this.isNoVolume=e;for(var t in this.channels){var n=this.channels[t];0==e?n.volume=0:0!=n.position&&(this.checkSoundIsBg(this.sounds,t)?n.volume=this.volumeBg:n.volume=this.volumeEffect)}},t.prototype.loadBgSound=function(e){this.loader=new egret.URLLoader,this.loader.addEventListener(egret.Event.COMPLETE,this.soundPlayComplete,this),this.loader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.soundLoadFail,this),this.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader.load(new egret.URLRequest(e))},t.prototype.soundPlayComplete=function(e){var t=this.loader.data;this.addItem("bgMusic",t,!0),this.play("bgMusic",0,0)},t.prototype.soundLoadFail=function(e){alert("声音加载失败")},t.bgMusic="bgMusic",t}(egret.HashObject);__reflect(SoundManager.prototype,"SoundManager");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Events;!function(e){var t=function(e){function t(t,n,i,o){void 0===n&&(n=null),void 0===i&&(i=!1),void 0===o&&(o=!1);var r=e.call(this,t,i,o)||this;return r.data=null,r.data=n,r}return __extends(t,e),t.GET_INFO_SUCESS="GET_INFO_SUCESS",t.GET_RANK_SUCESS="GET_RANK_SUCESS",t.UP_SOCRE_SUCESS="UP_SOCRE_SUCESS",t.GET_USERRANK_SUCESS="GET_USERRANK_SUCESS",t.GAME_START="GAME_START",t}(egret.Event);e.CommonEvent=t,__reflect(t.prototype,"Events.CommonEvent")}(Events||(Events={}));var fighter;!function(e){var t=function(t){function n(e,n,i){var o=t.call(this)||this;return o.fireDelay=n,o.textureName=i,"f2_png"==i?(o.bmp=new egret.Bitmap(e),o.addChild(o.bmp)):(o._dragDisplay=DrangonBoneUtil.createIdelDrangonBone("F_zhanshen20"),o._dragDisplay.anchorOffsetX=o._dragDisplay.width/2*-1,o._dragDisplay.anchorOffsetY=o._dragDisplay.height/2*-1,o.addChild(o._dragDisplay)),o.addBloodProcess(),o.fireTimer=new egret.Timer(n),o.fireTimer.addEventListener(egret.TimerEvent.TIMER,o.createBullet,o),o}return __extends(n,t),n.produce=function(t,n){null==e.Airplane.cacheDict[t]&&(e.Airplane.cacheDict[t]=[]);var i,o=e.Airplane.cacheDict[t];return i=o.length>0?o.pop():new e.Airplane(RES.getRes(t),n,t),i.blood="f2_png"==t?GameConfig.enmeyPanelBlood:GameConfig.myPlaneBlood,i},n.reclaim=function(t){var n=t.textureName;null==e.Airplane.cacheDict[n]&&(e.Airplane.cacheDict[n]=[]);var i=e.Airplane.cacheDict[n];-1==i.indexOf(t)&&i.push(t)},Object.defineProperty(n.prototype,"blood",{get:function(){return this._blo},set:function(e){this.myPro.value=e,this._blo=e},enumerable:!0,configurable:!0}),n.prototype.addBloodProcess=function(){this.myPro=new eui.ProgressBar,this.myPro.skinName="resource/eui_skins/bloodProcess.exml",this.myPro.minimum=0,this.myPro.maximum="f2_png"==this.textureName?GameConfig.enmeyPanelBlood:GameConfig.myPlaneBlood,this.myPro.width=.7*this.width,this.myPro.x=(this.width-this.myPro.width)/2,this.myPro.y="f2_png"==this.textureName?this.bmp.y-this.myPro.height:this._dragDisplay.y+this._dragDisplay.height,this.addChild(this.myPro)},n.prototype.fire=function(){this.fireTimer.start()},n.prototype.stopFire=function(){this.fireTimer.stop()},n.prototype.createBullet=function(e){this.dispatchEventWith("createBullet")},n.cacheDict={},n}(egret.DisplayObjectContainer);e.Airplane=t,__reflect(t.prototype,"fighter.Airplane")}(fighter||(fighter={}));var fighter;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.speed=2,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.stageW=Layout.getInstance().stage.stageWidth,this.stageH=Layout.getInstance().stage.stageHeight;var t=RES.getRes("bg_jpg");this.textureHeight=t.textureHeight,this.rowCount=Math.ceil(this.stageH/this.textureHeight)+1,this.bmpArr=[];for(var n=0;n<this.rowCount;n++){var i=utils.createBitmapByName("bg_jpg");i.y=this.textureHeight*n-(this.textureHeight*this.rowCount-this.stageH),i.width=this.stageW,this.bmpArr.push(i),this.addChild(i)}},t.prototype.start=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)},t.prototype.enterFrameHandler=function(e){for(var t=0;t<this.rowCount;t++){var n=this.bmpArr[t];n.y+=this.speed,n.y>this.stageH&&(n.y=this.bmpArr[0].y-this.textureHeight,this.bmpArr.pop(),this.bmpArr.unshift(n))}},t.prototype.pause=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)},t}(egret.DisplayObjectContainer);e.BgMap=t,__reflect(t.prototype,"fighter.BgMap")}(fighter||(fighter={}));var fighter;!function(e){var t=function(t){function n(e,n){var i=t.call(this,e)||this;return i.textureName=n,i}return __extends(n,t),n.produce=function(t){null==e.Bullet.cacheDict[t]&&(e.Bullet.cacheDict[t]=[]);var n,i=e.Bullet.cacheDict[t];return n=i.length>0?i.pop():new e.Bullet(RES.getRes(t),t)},n.reclaim=function(t){var n=t.textureName;null==e.Bullet.cacheDict[n]&&(e.Bullet.cacheDict[n]=[]);var i=e.Bullet.cacheDict[n];-1==i.indexOf(t)&&i.push(t)},n.cacheDict={},n}(egret.Bitmap);e.Bullet=t,__reflect(t.prototype,"fighter.Bullet")}(fighter||(fighter={}));var DrangonBoneUtil=function(){function e(){}return e.createIdelDrangonBone=function(e){void 0===e&&(e="F_zhanshen20");var t=RES.getRes(e+"_ske_json"),n=RES.getRes(e+"_tex_json"),i=RES.getRes(e+"_tex_png"),o=dragonBones.EgretFactory.factory;o.parseDragonBonesData(t),o.parseTextureAtlasData(n,i);var r=o.buildArmatureDisplay(e);return r.animation.play("idle"),r},e}();__reflect(DrangonBoneUtil.prototype,"DrangonBoneUtil");var utils;!function(e){function t(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t}var n=function(){function e(){}return e.hitTest=function(t,n){var i,o,r=1;return r=t instanceof fighter.Bullet?1:.6,i=e.createSelfBound(t,r),r=n instanceof fighter.Airplane?.6:1,o=e.createSelfBound(n,r),i.intersects(o)},e.createSelfBound=function(e,t){void 0===t&&(t=1);var n=e.width*t,i=e.height*t,o=(e.width-e.width*t)/2+e.x,r=(e.height-e.height*t)/2+e.y;return new egret.Rectangle(o,r,n,i)},e}();e.GameUtil=n,__reflect(n.prototype,"utils.GameUtil"),e.createBitmapByName=t}(utils||(utils={}));var utils;!function(e){var t=function(){function e(){}return e.getChar=function(e,t){var n=new egret.ByteArray;return n.writeUTFBytes(e),n.length<=t?e:(n.position=0,n.readUTFBytes(t)+"...")},e}();e.StringUtil=t,__reflect(t.prototype,"utils.StringUtil")}(utils||(utils={}));var fighter;!function(e){var t=component.BaseView,n=function(t){function n(){var e=t.call(this)||this;return e.myBullets=[],e.enemyFighters=[],e.enemyFightersTimer=new egret.Timer(1e3),e.enemyBullets=[],e.$myScore=0,e.timerCount=0,e.fullScreen=!0,e._lastTime=egret.getTimer(),e}return __extends(n,t),Object.defineProperty(n.prototype,"myScore",{get:function(){return this.$myScore},set:function(e){this.$myScore=e,this.scoreLab&&(this.scoreLab.text=""+e)},enumerable:!0,configurable:!0}),n.prototype.show=function(){t.prototype.show.call(this),this.stageW=Layout.getInstance().stage.stageWidth,this.stageH=Layout.getInstance().stage.stageHeight,this.map=new e.BgMap,this.addChild(this.map),this.contentCon=new egret.Sprite,this.addChild(this.contentCon),this.myFighter=new e.Airplane(RES.getRes("f1_png"),100,"f1_png"),this.myFighter.y=this.stageH-this.myFighter.height-50,this.contentCon.addChild(this.myFighter),this.scoreImg=new eui.Image,this.scoreImg.source="curSorce_png",this.scoreImg.x=40,this.scoreImg.y=60,this.addChild(this.scoreImg),this.scoreLab=new eui.Label,this.scoreLab.x=this.scoreImg.x+this.scoreImg.width+30,this.scoreLab.y=60,this.scoreLab.size=50,this.addChild(this.scoreLab),this.preCreatedInstance(),EventManager.addEventListener(Events.CommonEvent.GAME_START,this.gameStart,this),GlobalData.isInAPP||GlobalData.isNotFirstLogin?ModuleManager.getInstance().openModule("GameStartView"):(GlobalData.isNotFirstLogin=!0,ModuleManager.getInstance().openModule("GameRewardsView",{desc:GameConfig.noInAppNotic,titleUrl:"titleTips_png",showBtn:!0}))},n.prototype.preCreatedInstance=function(){var t=0,n=[];for(t=0;20>t;t++){var i=e.Bullet.produce("b1_png");n.push(i)}for(t=0;20>t;t++)i=n.pop(),e.Bullet.reclaim(i);for(t=0;20>t;t++){var i=e.Bullet.produce("b2_png");n.push(i)}for(t=0;20>t;t++)i=n.pop(),e.Bullet.reclaim(i);for(t=0;20>t;t++){var o=e.Airplane.produce("f2_png",1e3);n.push(o)}for(t=0;20>t;t++)o=n.pop(),e.Airplane.reclaim(o)},n.prototype.gameStart=function(e){var t=this;this.myScore=0,this.timerCount=0,this.map.start(),this.touchEnabled=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.myFighter.x=(this.stageW-this.myFighter.width)/2,SoundManager.getIns().play("readygo_mp3"),egret.setTimeout(function(){t.myFighter.fire()},this,2e3),this.myFighter.blood=GameConfig.myPlaneBlood,this.myFighter.addEventListener("createBullet",this.createBulletHandler,this),this.enemyFightersTimer.delay=1e3,this.enemyFightersTimer.addEventListener(egret.TimerEvent.TIMER,this.createEnemyFighter,this),this.enemyFightersTimer.start()},n.prototype.touchHandler=function(e){if(e.type==egret.TouchEvent.TOUCH_MOVE){var t=e.localX;t=Math.max(0,t),t=Math.min(this.stageW-this.myFighter.width,t),this.myFighter.x=t}},n.prototype.createBulletHandler=function(t){var n;if(t.target==this.myFighter)for(var i=0;2>i;i++)n=e.Bullet.produce("b1_png"),n.x=0==i?this.myFighter.x+30:this.myFighter.x+this.myFighter.width-72,n.y=this.myFighter.y-50,this.contentCon.addChildAt(n,this.numChildren-1-this.enemyFighters.length),this.myBullets.push(n);else{var o=t.target;n=e.Bullet.produce("b2_png"),n.x=o.x+28,n.y=o.y+10,this.contentCon.addChildAt(n,this.numChildren-1-this.enemyFighters.length),this.enemyBullets.push(n)}},n.prototype.createEnemyFighter=function(e){this.timerCount++,this.timerCount>=20&&(this.timerCount=0,this.enemyFightersTimer.delay>100&&(this.enemyFightersTimer.delay=this.enemyFightersTimer.delay-100)),this.realCreate()},n.prototype.realCreate=function(){var t=e.Airplane.produce("f2_png",1e3);t.x=Math.random()*(this.stageW-t.width),t.y=-t.height-300*Math.random(),t.addEventListener("createBullet",this.createBulletHandler,this),t.fire(),this.contentCon.addChildAt(t,this.numChildren-1),this.enemyFighters.push(t)},n.prototype.gameViewUpdate=function(t){var n=egret.getTimer(),i=1e3/(n-this._lastTime);this._lastTime=n;for(var o,r=60/i,s=0,a=this.myBullets.length;a>s;s++)o=this.myBullets[s],o.y<-o.height&&(this.contentCon.removeChild(o),e.Bullet.reclaim(o),this.myBullets.splice(s,1),s--,a--),o.y-=GameConfig.myBulletSpeed*r;var h,l=this.enemyFighters.length;for(s=0;l>s;s++)h=this.enemyFighters[s],h.y>this.stage.stageHeight&&(this.contentCon.removeChild(h),e.Airplane.reclaim(h),h.removeEventListener("createBullet",this.createBulletHandler,this),h.stopFire(),this.enemyFighters.splice(s,1),s--,l--),h.y+=4*r;var c=this.enemyBullets.length;for(s=0;c>s;s++)o=this.enemyBullets[s],o.y>this.stage.stageHeight&&(this.contentCon.removeChild(o),e.Bullet.reclaim(o),this.enemyBullets.splice(s,1),s--,c--),o.y+=GameConfig.enemyBulletSpeed*r;this.gameHitTest()},n.prototype.gameHitTest=function(){var t,n,i,o,r=this.myBullets.length,s=this.enemyFighters.length,a=this.enemyBullets.length,h=[],l=[];for(t=0;r>t;t++)for(i=this.myBullets[t],n=0;s>n;n++)o=this.enemyFighters[n],utils.GameUtil.hitTest(o,i)&&(o.blood-=GameConfig.myBulletHurt,-1==h.indexOf(i)&&h.push(i),o.blood<=0&&-1==l.indexOf(o)&&(SoundManager.getIns().play("bomb_mp3"),l.push(o)));
for(t=0;a>t;t++)i=this.enemyBullets[t],utils.GameUtil.hitTest(this.myFighter,i)&&(this.myFighter.blood-=GameConfig.enemyBulletHurt,-1==h.indexOf(i)&&h.push(i));for(t=0;s>t;t++)o=this.enemyFighters[t],utils.GameUtil.hitTest(this.myFighter,o)&&(this.myFighter.blood-=GameConfig.hitHurt);if(this.myFighter.blood<=0)this.gameStop();else{for(;h.length>0;)i=h.pop(),this.contentCon.removeChild(i),"b1_png"==i.textureName?this.myBullets.splice(this.myBullets.indexOf(i),1):this.enemyBullets.splice(this.enemyBullets.indexOf(i),1),e.Bullet.reclaim(i);for(this.myScore+=l.length;l.length>0;)o=l.pop(),o.stopFire(),o.removeEventListener("createBullet",this.createBulletHandler,this),this.contentCon.removeChild(o),this.enemyFighters.splice(this.enemyFighters.indexOf(o),1),e.Airplane.reclaim(o)}},n.prototype.gameStop=function(){this.map.pause(),this.removeEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.myFighter.stopFire(),this.myFighter.removeEventListener("createBullet",this.createBulletHandler,this),this.enemyFightersTimer.removeEventListener(egret.TimerEvent.TIMER,this.createEnemyFighter,this),this.enemyFightersTimer.stop();for(var t;this.myBullets.length>0;)t=this.myBullets.pop(),this.contentCon.removeChild(t),e.Bullet.reclaim(t);for(;this.enemyBullets.length>0;)t=this.enemyBullets.pop(),this.contentCon.removeChild(t),e.Bullet.reclaim(t);for(var n;this.enemyFighters.length>0;)n=this.enemyFighters.pop(),n.stopFire(),n.removeEventListener("createBullet",this.createBulletHandler,this),this.contentCon.removeChild(n),e.Airplane.reclaim(n);GlobalData.score=this.myScore,ModuleManager.getInstance().openModule("GameEndView")},n}(t);e.GameContainer=n,__reflect(n.prototype,"fighter.GameContainer")}(fighter||(fighter={}));var GlobalData=Model.GlobalData,GameEndView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/GameEndSkin.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onshow,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0},t.prototype.onshow=function(){return this.topScore.text="",GlobalData.isInAPP?(this.notIngameText.visible=!1,EventManager.addEventListener(Events.CommonEvent.UP_SOCRE_SUCESS,this.onUpSocre,this),void HttpCommand.getInstance().reportResult(GlobalData.userID,GlobalData.score)):(this.myscore.text=""+GlobalData.score,this.topScore.text="",this.initEvent(),void(this.notIngameText.visible=!0))},t.prototype.initEvent=function(){this.restartBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.allRank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRank,this)},t.prototype.onUpSocre=function(e){this.initEvent(),console.log("开始请求"),EventManager.removeEventListener(Events.CommonEvent.UP_SOCRE_SUCESS,this.onUpSocre,this),EventManager.addEventListener(Events.CommonEvent.GET_USERRANK_SUCESS,this.onGetUserRank,this),HttpCommand.getInstance().getUserRank(GlobalData.userID)},t.prototype.onGetUserRank=function(e){var t=e.data,n=(t[0],[]);t.prevMember&&t.prevMember.userid&&n.push(t.prevMember),t[0]&&(t[0].self=!0,n.push(t[0])),t.nextMember&&t.nextMember.userid&&n.push(t.nextMember),this.myscore.text=""+GlobalData.score;for(var i=0;i<n.length;i++){var o=n[i],r=new EndRankItem(o);this.subGroup.addChild(r),r.x=186*i}EventManager.removeEventListener(Events.CommonEvent.GET_USERRANK_SUCESS,this.onGetUserRank,this)},t.prototype.onRestart=function(e){this.onClose(null)},t.prototype.onClose=function(e){ModuleManager.getInstance().destroyForInstance(this),ModuleManager.getInstance().openModule("GameStartView")},t.prototype.onRank=function(e){ModuleManager.getInstance().openModule("RankListView")},t.prototype.hide=function(){EventManager.removeEventListener(Events.CommonEvent.UP_SOCRE_SUCESS,this.onUpSocre,this),EventManager.removeEventListener(Events.CommonEvent.GET_USERRANK_SUCESS,this.onGetUserRank,this),this.restartBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.restartBtn=null,this.closeBtn=null,this.allRank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRank,this),this.allRank=null,e.prototype.hide.call(this)},t}(component.BaseView);__reflect(GameEndView.prototype,"GameEndView");var GameInfoView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/GameInfo.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.desc.text=GameConfig.gameIntro,this.goBackBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onClose=function(t){e.prototype.hide.call(this)},t}(component.BaseView);__reflect(GameInfoView.prototype,"GameInfoView");var GameInfoVGameNoInAppViewiew=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/UninAppNotic.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.gameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.linkBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLink,this)},t.prototype.onClose=function(t){e.prototype.hide.call(this),GlobalData.isNotFirstLogin||(GlobalData.isNotFirstLogin=!0,ModuleManager.getInstance().openModule("GameInfoView"))},t.prototype.onLink=function(e){window.open(GameConfig.downloadUrl)},t}(component.BaseView);__reflect(GameInfoVGameNoInAppViewiew.prototype,"GameInfoVGameNoInAppViewiew");var GameRewardsView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/RewardsSkin.exml",t}return __extends(t,e),t.prototype.init=function(e){void 0===e&&(e=null),this.initData=e},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.desc.text=this.initData.desc,this.title.source=this.initData.titleUrl,this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.gameBtn.visible=this.initData.showBtn,this.linkBtn.visible=this.initData.showBtn,this.initData.showBtn&&(this.gameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStart,this),this.linkBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLink,this))},t.prototype.onClose=function(t){e.prototype.hide.call(this),this.initData.showBtn&&ModuleManager.getInstance().openModule("GameStartView")},t.prototype.onLink=function(e){window.open(GameConfig.downloadUrl)},t.prototype.gameStart=function(t){e.prototype.hide.call(this),ModuleManager.getInstance().openModule("GameStartView")},t}(component.BaseView);__reflect(GameRewardsView.prototype,"GameRewardsView");var GameStartView=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/GameStartSkin.exml",t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),this.rankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRank,this),this.infoBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onInfo,this),this.rewardBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReward,this)},t.prototype.onRestart=function(e){GlobalData.score=0,ModuleManager.getInstance().destroyForInstance(this),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GAME_START))},t.prototype.onRank=function(e){ModuleManager.getInstance().openModule("RankListView")},t.prototype.onInfo=function(e){ModuleManager.getInstance().openModule("GameRewardsView",{desc:GameConfig.gameIntro,titleUrl:"titleInfo_png",showBtn:!1})},t.prototype.onReward=function(e){ModuleManager.getInstance().openModule("GameRewardsView",{desc:GameConfig.awardExplain,titleUrl:"titleAward_png",showBtn:!1})},t}(component.BaseView);__reflect(GameStartView.prototype,"GameStartView");var EndRankItem=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n.skinName="resource/eui_skins/EndRankItemSkin.exml",n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.init()},t.prototype.init=function(){var e=!!this.data.self;this.nameText.text=utils.StringUtil.getChar(this.data.userName,18),this.rank.textColor=e?3766780:13383728,e?this.currentState="selet":this.currentState="unSelect",this.userPic.source=""+this.data.userPic,this.rank.text=""+this.data.userNumber1,this.score.text=""+this.data.userScore},t}(eui.Component);__reflect(EndRankItem.prototype,"EndRankItem");var RankData=Model.RankData,RankListView=function(e){function t(){var t=e.call(this)||this;return t.initX=0,t.initY=0,t.skinName="resource/eui_skins/RankPanel.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onshow,t),t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.onChange=function(e){"tabBtn2Skin"==e.currentTarget.skinName?this.curType=2:this.curType=1,this.changeRank()},t.prototype.onshow=function(){EventManager.addEventListener(Events.CommonEvent.GET_RANK_SUCESS,this.renderData,this),this.curType=1,this.changeRank(),this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBack,this),this.mylist.itemRenderer=RankListItemRenderer,this.nationBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.localBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this)},t.prototype.detroy=function(){EventManager.removeEventListener(Events.CommonEvent.GET_RANK_SUCESS,this.renderData,this),this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBack,this),this.nationBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.localBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this)},t.prototype.begin=function(e){this.initX=e.stageX,this.initY=e.stageY},t.prototype.end=function(e){(e.stageX-this.initX>200||e.stageX-this.initX<-200)&&(this.mylist.dataProvider=null,this.curType=1==this.curType?2:1,this.changeRank())},t.prototype.onBack=function(e){ModuleManager.getInstance().destroyForInstance(this)},t.prototype.changeRank=function(){this.scroller&&this.scroller.stopAnimation(),this.mylist&&(this.mylist.scrollV=0),1==this.curType?(this.localBtn.currentState="down",this.nationBtn.currentState="up",this.touchChildren=this.touchEnabled=!1,HttpCommand.getInstance().getRankList(this.curType)):(this.localBtn.currentState="up",this.nationBtn.currentState="down",this.touchChildren=this.touchEnabled=!1,HttpCommand.getInstance().getRankList(this.curType))},t.prototype.renderData=function(e){if(void 0===e&&(e=null),this.touchChildren=this.touchEnabled=!0,!e||parseInt(e.data)==this.curType){var t;t=1==this.curType?RankData.getInstance().localSortList:RankData.getInstance().nationSortList,this.mylist.dataProvider=new eui.ArrayCollection(t),this.mylist.scrollV=0}},t}(component.BaseView);__reflect(RankListView.prototype,"RankListView");var RankListItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/RankListItem.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.scaleX=Layout.getInstance().scaleX},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.data.userName=utils.StringUtil.getChar(this.data.userName,18),this.itemIndex<3?(this.scoreTxt.textColor=16711680,this.currentState="order",this.orderPic.source=RES.getRes("order"+(this.itemIndex+1)+"_png")):(this.currentState="nomorl",this.order.text=""+(this.itemIndex+1),this.scoreTxt.textColor=3355443),this.userPic.source=""+this.data.userPic},t}(eui.ItemRenderer);__reflect(RankListItemRenderer.prototype,"RankListItemRenderer");
var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Model;!function(e){var t=function(){function e(){}return e.isFirstLog=!1,e.version=201605241700,e.score=0,e.isInAPP=!1,e.userID="599",e.appID=1,e.postJosn={domain:"",appId:0,sort:0},e}();e.GlobalData=t,__reflect(t.prototype,"Model.GlobalData")}(Model||(Model={}));var Manager;!function(e){var t=egret.getDefinitionByName,n=function(){function e(){this.maps={}}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.openModule=function(e,n){void 0===n&&(n=null),console.log("打开模块："+e);var i;if(this.maps.hasOwnProperty(e))i=this.maps[e];else{var r=t(e);i=new r,this.maps[e]=i}n&&i.init(n),i.show()},e.prototype.hideModel=function(e){void 0===e&&(e="");var t=this.maps[e];t&&t.hide(),console.log("hide模块："+e)},e.prototype.destoryModule=function(e){void 0===e&&(e="");var t=this.maps[e];t&&(t.dispose(),t=null,delete this.maps[e]),console.log("关闭模块："+e)},e.prototype.isContain=function(e){return this.maps.hasOwnProperty(e)?!0:!1},e.prototype.destoryAll=function(){var e;for(e in this.maps)this.destoryModule(e);this.maps={}},e.prototype.destroyForInstance=function(e){var t=egret.getQualifiedClassName(e);this.destoryModule(t)},e.prototype.traceMap=function(){var e;for(e in this.maps)console.log(e)},e}();e.ModuleManager=n,__reflect(n.prototype,"Manager.ModuleManager")}(Manager||(Manager={}));var config;!function(e){var t=function(){function e(){}return e.paserJosn=function(e){this.appName=e.appName,this.bgMusic=e.bgMusic,this.bgImage=e.bgImage,this.adSlogan=e.adSlogan,this.appExplain=e.appExplain,this.gameIntro=e.gameIntro,this.startTime=e.startTime,this.endTime=e.endTime,this.thumb=e.thumb,this.beginMessage=e.beginMessage,this.endMessage=e.endMessage,this.setGameContend(e.blockContent)},e.setGameContend=function(e){this.myBulletSpeed=parseInt(e.myBulletSpeed)||12,this.myBulletHurt=parseInt(e.myBulletHurt)||2,this.enemyBulletSpeed=parseInt(e.enemyBulletSpeed)||8,this.enemyBulletHurt=parseInt(e.enemyBulletHurt)||1,this.myPlaneBlood=parseInt(e.myPlaneBlood)||12,this.enmeyPanelBlood=parseInt(e.enmeyPanelBlood)||10,this.hitHurt=parseInt(e.hitHurt)||12},e.gameId=3,e}();e.GameConfig=t,__reflect(t.prototype,"config.GameConfig")}(config||(config={}));var Model;!function(e){var t=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.localRankList=function(e){this.localSortList=e,this.localSortList.length>1&&this.localSortList.sort(this.compare),this.localGet=!0},e.prototype.nationRankList=function(e){this.nationSortList=e,this.nationSortList.length>1&&this.nationSortList.sort(this.compare),this.nationGet=!0},e.prototype.compare=function(e,t){var n=parseInt(e.userScore),i=parseInt(t.userScore);return n>i?-1:i>n?1:0},e}();e.RankData=t,__reflect(t.prototype,"Model.RankData")}(Model||(Model={}));var Manager;!function(e){var t=function(t){function n(){return t.call(this)||this}return __extends(n,t),n.getInstance=function(){return null==this.instance&&(this.instance=new n),this.instance},n.prototype.startGame=function(){this._mapLevel=new egret.Sprite,this._gameLvel=new eui.Group,this._appLevel=new eui.Group,this._topLevel=new eui.Group,this._loadLevel=new eui.Group,this._appLevel.width=e.Layout.getInstance().stage.stageWidth,this._appLevel.height=e.Layout.getInstance().stage.stageHeight,this._appLevel.touchEnabled=!1,this._appLevel.layout=new eui.BasicLayout,e.Layout.getInstance().stage.addChild(this._mapLevel),e.Layout.getInstance().stage.addChild(this._gameLvel),e.Layout.getInstance().stage.addChild(this._appLevel),e.Layout.getInstance().stage.addChild(this._topLevel),e.Layout.getInstance().stage.addChild(this._loadLevel)},Object.defineProperty(n.prototype,"appLevel",{get:function(){return this._appLevel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mapLevel",{get:function(){return this._mapLevel},enumerable:!0,configurable:!0}),n}(egret.EventDispatcher);e.UIManager=t,__reflect(t.prototype,"Manager.UIManager")}(Manager||(Manager={}));var Manager;!function(e){var t=function(){function e(){this._scaleY=1,this._scaleX=1}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(e){if(this.Mstage=e,!egret.Capabilities.isMobile)return void(this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL);console.log("当前渲染模式："+egret.Capabilities.renderMode),console.log("边界"+egret.Capabilities.boundingClientWidth+"*"+egret.Capabilities.boundingClientHeight);var t=egret.Capabilities.boundingClientWidth,n=egret.Capabilities.boundingClientHeight,i=t/n,r=720,s=1280;r/s>i?this.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT:this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH,this._scaleX=this.stage.stageWidth/r,this._scaleY=this.stage.stageHeight/s,console.log("stageWidth"+this.stage.stageWidth+";stageHeight"+this.stage.stageHeight),console.log("scaleX:"+this._scaleX+";scaleY:"+this._scaleY)},Object.defineProperty(e.prototype,"stage",{get:function(){return this.Mstage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scaleX<this._scaleY?this._scaleX:this._scaleY},enumerable:!0,configurable:!0}),e.firstLevel=0,e.secondLevel=1,e.thirdLevel=2,e}();e.Layout=t,__reflect(t.prototype,"Manager.Layout")}(Manager||(Manager={}));var utils;!function(e){var t=function(){function e(){}return e.setCenter=function(e){e.x=(Layout.getInstance().stage.stageWidth-e.width)/2,e.y=(Layout.getInstance().stage.stageHeight-e.height)/2},e.getShape=function(e,t,n,i){void 0===e&&(e=640),void 0===t&&(t=960),void 0===n&&(n=0),void 0===i&&(i=.7);var r=new egret.Sprite,s=new egret.Shape;return s.graphics.beginFill(n,i),s.graphics.drawRect(0,0,e,t),s.graphics.endFill(),s.touchEnabled=!1,r.addChild(s),r},e.getArtNum=function(e,t){for(var n=new egret.Sprite,i=0;i<t.length;){var r=RES.getRes(e+t.charAt(i)),s=new egret.Bitmap(r);s.x=n.width+1,s.y=-r.textureHeight/2,n.addChild(s)}return n},e.hitTest=function(e,t){var n=e.getBounds(),i=t.getBounds();return n.x=e.x,n.y=e.y,i.x=t.x,i.y=t.y,n.intersects(i)},e}();e.ViewUtil=t,__reflect(t.prototype,"utils.ViewUtil")}(utils||(utils={}));var component;!function(e){var t=Manager.Layout,n=Manager.UIManager,i=Manager.ModuleManager,r=utils.ViewUtil,s=function(e){function s(){var t=e.call(this)||this;return t.addBlackBg=!0,t.fullScreen=!1,t.verticalCenter=t.horizontalCenter=0,t}return __extends(s,e),s.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},s.prototype.init=function(e){void 0===e&&(e=null)},s.prototype.show=function(){this.addBlackBg&&this.addBg(),this.fullScreen&&(this.width=t.getInstance().stage.stageWidth,this.height=t.getInstance().stage.stageHeight),n.getInstance().appLevel.addChild(this)},s.prototype.addBg=function(){this.bg=r.getShape(t.getInstance().stage.stageWidth,t.getInstance().stage.stageHeight,0,.5),n.getInstance().appLevel.addChild(this.bg),this.bg.touchEnabled=!0},s.prototype.hide=function(){i.getInstance().destroyForInstance(this)},s.prototype.dispose=function(){n.getInstance().appLevel.removeChild(this),this.bg&&this.bg.parent&&this.bg.parent.removeChild(this.bg),this.bg=null},s}(eui.Component);e.BaseView=s,__reflect(s.prototype,"component.BaseView")}(component||(component={}));var Manager;!function(e){var t=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new egret.EventDispatcher),this.instance},e.addEventListener=function(e,t,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=1),this.getInstance().addEventListener(e,t,n,i,r)},e.removeEventListener=function(e,t,n,i){void 0===i&&(i=!1),this.getInstance().removeEventListener(e,t,n,i)},e.dispatchEvent=function(e){this.getInstance().dispatchEvent(e)},e}();e.EventManager=t,__reflect(t.prototype,"Manager.EventManager")}(Manager||(Manager={}));var Events;!function(e){var t=function(e){function t(t,n,i,r){void 0===n&&(n=null),void 0===i&&(i=!1),void 0===r&&(r=!1);var s=e.call(this,t,i,r)||this;return s.data=null,s.data=n,s}return __extends(t,e),t.GET_INFO_SUCESS="GET_INFO_SUCESS",t.GET_RANK_SUCESS="GET_RANK_SUCESS",t.UP_SOCRE_SUCESS="UP_SOCRE_SUCESS",t.GET_USERRANK_SUCESS="GET_USERRANK_SUCESS",t}(egret.Event);e.CommonEvent=t,__reflect(t.prototype,"Events.CommonEvent")}(Events||(Events={}));var proxy;!function(e){var t=config.GameConfig,n=Model.GlobalData,i=Model.RankData,r=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.getGameConfig=function(i){void 0===i&&(i=1);var r="http://"+n.gameDomainURL+"/index.php?m=content&c=litAppBlock&a=index&mobileDomain="+n.gameDomainURL+"&gameID="+t.gameId+"&requstID="+e.GameConfigID;console.log("curURL:"+r),this.postRequset(r)},e.prototype.reportResult=function(i,r,s){void 0===s&&(s=0);var o="http://"+n.gameDomainURL+"/index.php?m=content&c=acceptResult&a=add&domain="+n.gameDomainURL+"&userId="+i+"&appId="+t.gameId+"&score="+r+"&bonus="+s+"&requstID="+e.reportResultID;this.postRequset(o)},e.prototype.getRankList=function(i){void 0===i&&(i=0);var r="http://"+n.gameDomainURL+"/index.php?m=content&c=userRankingList&a=showList&domain="+n.gameDomainURL+"&appId="+t.gameId+"&sort="+i+"&requstID="+e.rankInfoID;this.postRequset(r)},e.prototype.getUserRank=function(i){var r="http://"+n.gameDomainURL+"/index.php?m=content&c=currentUserNumber&a=showIndex&userId="+i+"&gameId="+t.gameId+"&requstID="+e.userRank;this.postRequset(r)},e.prototype.postRequset=function(e){var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open(e,egret.HttpMethod.POST),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(n){var r=n.currentTarget;this.removeEvent(r);var s=JSON.parse(r.response);if(parseInt(s.StatusCode)>0){var o=s.retData,a=parseInt(o.requstID||o[0].requstID);switch(a){case e.GameConfigID:t.paserJosn(o[0]),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_INFO_SUCESS));break;case e.rankInfoID:if(o.length<=0)return void EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_RANK_SUCESS,0));1==parseInt(o[0].sort)?i.getInstance().localRankList(o):i.getInstance().nationRankList(o),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_RANK_SUCESS,parseInt(o[0].sort)));break;case e.reportResultID:console.log("上报成功！！"),EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.UP_SOCRE_SUCESS));break;case e.userRank:o?EventManager.dispatchEvent(new Events.CommonEvent(Events.CommonEvent.GET_USERRANK_SUCESS,o)):alert("数据为空！")}}else alert(s.retMessage)},e.prototype.onGetIOError=function(e){console.log("postError:"+e),this.removeEvent(e.currentTarget)},e.prototype.onGetProgress=function(e){},e.prototype.removeEvent=function(e){e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.getString=function(e){return"0000"},e.GameConfigID=1,e.reportResultID=2,e.rankInfoID=3,e.userRank=4,e}();e.HttpCommand=r,__reflect(r.prototype,"proxy.HttpCommand")}(proxy||(proxy={}));var proxy;!function(proxy){var GlobalData=Model.GlobalData,PlayerInfoProxy=function(){function PlayerInfoProxy(){}return PlayerInfoProxy.getInstance=function(){return null==this.instance&&(this.instance=new PlayerInfoProxy),this.instance},PlayerInfoProxy.prototype.getMyInfo=function(){var u=navigator.userAgent,isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1,isiOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);GlobalData.gameDomainURL=window.location.host,GlobalData.isIOS=isiOS;var uInfo,josnStr;if(window.location.href.indexOf("onapp")>-1){if(GlobalData.isInAPP=!0,isAndroid)try{josnStr=eval("android.getUserInfo()"),uInfo=eval("("+josnStr+")"),null!=uInfo&&uInfo.userLogin?this.getInfoSucess(uInfo):eval("android.goLogin()")}catch(error){console.log("调用失败"),this.getInfoFail()}else if(isiOS)try{josnStr=eval("OCModel.getUserInfo()"),uInfo=eval("("+josnStr+")"),null!=uInfo&&uInfo.userLogin?this.getInfoSucess(uInfo):eval("OCModel.getLogin()")}catch(error){console.log("调用失败"),this.getInfoFail()}}else console.log("非APP中"),GlobalData.isInAPP=!1,this.getInfoFail()},PlayerInfoProxy.prototype.getInfoSucess=function(e){e&&(GlobalData.isInAPP=!0,GlobalData.userName=e.userName,GlobalData.userImg=e.userImg,GlobalData.appID=parseInt(e.Appid),GlobalData.openId=parseInt(e.openid),GlobalData.unionid=parseInt(e.unionid),GlobalData.userID=e.userLogin,GlobalData.telephoneId=parseInt(e.userPhone),GlobalData.passId=parseInt(e.userPwd))},PlayerInfoProxy.prototype.getInfoFail=function(){},PlayerInfoProxy}();proxy.PlayerInfoProxy=PlayerInfoProxy,__reflect(PlayerInfoProxy.prototype,"proxy.PlayerInfoProxy")}(proxy||(proxy={}));var utils;!function(e){var t=function(){function e(){}return e.getChar=function(e,t){var n=new egret.ByteArray;return n.writeUTFBytes(e),n.length<=t?e:(n.position=0,n.readUTFBytes(t)+"...")},e}();e.StringUtil=t,__reflect(t.prototype,"utils.StringUtil")}(utils||(utils={}));var ModuleManager=Manager.ModuleManager,Layout=Manager.Layout,EventManager=Manager.EventManager,PlayerInfoProxy=proxy.PlayerInfoProxy,HttpCommand=proxy.HttpCommand,GameConfig=config.GameConfig,Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},egret.ImageLoader.crossOrigin="anonymous",Layout.getInstance().init(this.stage);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),PlayerInfoProxy.getInstance().getMyInfo(),EventManager.addEventListener(Events.CommonEvent.GET_INFO_SUCESS,this.loadGameDataBack,this),HttpCommand.getInstance().getGameConfig(2)},t.prototype.loadGameDataBack=function(){EventManager.removeEventListener(Events.CommonEvent.GET_INFO_SUCESS,this.loadGameDataBack,this),document.title=GameConfig.appName||"2048小游戏",RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){SoundManager.getIns().addItem("bgm_mp3",null,!0),SoundManager.getIns().play("bgm_mp3",0,0),Manager.UIManager.getInstance().startGame(),Manager.ModuleManager.getInstance().openModule("fighter.GameContainer")},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function r(e){t.call(i,e)}function s(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var SoundManager=function(e){function t(){var t=e.call(this)||this;return t.sounds={},t.channels={},t.volumeBg=1,t.volumeEffect=1,t.isNoVolume=1,t._activated=!0,Layout.getInstance().stage.addEventListener(egret.Event.ACTIVATE,t.stage_activateHandler,t),Layout.getInstance().stage.addEventListener(egret.Event.DEACTIVATE,t.stage_activateHandler,t),t}return __extends(t,e),t.getIns=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.stage_activateHandler=function(e){if(this._activated=e.type==egret.Event.ACTIVATE,this._activated){var t=parseInt(egret.localStorage.getItem("sound.bgVol"));console.log("bgVo:"+t+":"+egret.localStorage.getItem("sound.bgVol")),this.setBgVolume(t)}else egret.localStorage.setItem("sound.bgVol",""+this.volumeBg),this.setBgVolume(0)},t.prototype.checkSoundIsBg=function(e,t){return e[t+"-bg"]},t.prototype.addItem=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var i=e;n&&(i=e+"-bg"),t?this.sounds[i]=t:this.sounds[i]||(t=RES.getRes(e),this.sounds[i]=t)},t.prototype.addBgMusic=function(e){e.indexOf("http")>0?this.addItem(e,null,!0):this.loadBgSound(e)},t.prototype.play=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=1),null==this.sounds[e]&&this.addItem(e);var i=this.volumeEffect;if(this.checkSoundIsBg(this.sounds,e)&&(e+="-bg",i=this.volumeBg),this.sounds[e]){var r=this.sounds[e];this.channels[e]=r.play(t,n),0==this.isNoVolume?this.channels[e].volume=0:this.channels[e].volume=i}},t.prototype.stop=function(e){if(this.checkSoundIsBg(this.channels,e)&&(e+="-bg"),this.channels[e]){var t=this.channels[e];t.stop()}},t.prototype.setVolume=function(e,t){if(this.checkSoundIsBg(this.channels,e)&&(e+="-bg"),this.channels[e]){var n=this.channels[e];n.volume=t}},t.prototype.setBgVolume=function(e){for(var t in this.channels)if(2==t.split("-bg").length){var n=this.channels[t];this.volumeBg=e,0!=n.position&&(n.volume=e)}},t.prototype.setEffectVolume=function(e){for(var t in this.channels)if(1==t.split("-bg").length){var n=this.channels[t];this.volumeEffect=e,0!=n.position&&(n.volume=e)}},t.prototype.setIsNoVolume=function(e){this.isNoVolume=e;for(var t in this.channels){var n=this.channels[t];0==e?n.volume=0:0!=n.position&&(this.checkSoundIsBg(this.sounds,t)?n.volume=this.volumeBg:n.volume=this.volumeEffect)}},t.prototype.loadBgSound=function(e){this.loader=new egret.URLLoader,this.loader.addEventListener(egret.Event.COMPLETE,this.soundPlayComplete,this),this.loader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.soundLoadFail,this),this.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,this.loader.load(new egret.URLRequest(e))},t.prototype.soundPlayComplete=function(e){var t=this.loader.data;this.addItem("bgMusic",t,!0),this.play("bgMusic",0,0)},t.prototype.soundLoadFail=function(e){alert("声音加载失败")},t.bgMusic="bgMusic",t}(egret.HashObject);__reflect(SoundManager.prototype,"SoundManager");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var fighter;!function(e){var t=function(t){function n(e,n,i){var r=t.call(this)||this;return r.fireDelay=n,r.textureName=i,"f2_png"==i?(r.bmp=new egret.Bitmap(e),r.addChild(r.bmp)):(r._dragDisplay=DrangonBoneUtil.createIdelDrangonBone("F_zhanshen20"),r._dragDisplay.anchorOffsetX=r._dragDisplay.width/2*-1,r._dragDisplay.anchorOffsetY=r._dragDisplay.height/2*-1,r.addChild(r._dragDisplay)),r.addBloodProcess(),r.fireTimer=new egret.Timer(n),r.fireTimer.addEventListener(egret.TimerEvent.TIMER,r.createBullet,r),r}return __extends(n,t),n.produce=function(t,n){null==e.Airplane.cacheDict[t]&&(e.Airplane.cacheDict[t]=[]);var i,r=e.Airplane.cacheDict[t];return i=r.length>0?r.pop():new e.Airplane(RES.getRes(t),n,t),i.blood="f2_png"==t?GameConfig.enmeyPanelBlood:GameConfig.myPlaneBlood,i},n.reclaim=function(t){var n=t.textureName;null==e.Airplane.cacheDict[n]&&(e.Airplane.cacheDict[n]=[]);var i=e.Airplane.cacheDict[n];-1==i.indexOf(t)&&i.push(t)},Object.defineProperty(n.prototype,"blood",{get:function(){return this._blo},set:function(e){this.myPro.value=e,this._blo=e},enumerable:!0,configurable:!0}),n.prototype.addBloodProcess=function(){this.myPro=new eui.ProgressBar,this.myPro.skinName="resource/eui_skins/bloodProcess.exml",this.myPro.minimum=0,this.myPro.maximum="f2_png"==this.textureName?GameConfig.enmeyPanelBlood:GameConfig.myPlaneBlood,this.myPro.width=.7*this.width,this.myPro.x=(this.width-this.myPro.width)/2,this.myPro.y="f2_png"==this.textureName?this.bmp.y-this.myPro.height:this._dragDisplay.y+this._dragDisplay.height,this.addChild(this.myPro)},n.prototype.fire=function(){this.fireTimer.start()},n.prototype.stopFire=function(){this.fireTimer.stop()},n.prototype.createBullet=function(e){this.dispatchEventWith("createBullet")},n.cacheDict={},n}(egret.DisplayObjectContainer);e.Airplane=t,__reflect(t.prototype,"fighter.Airplane")}(fighter||(fighter={}));var fighter;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.speed=2,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.stageW=Layout.getInstance().stage.stageWidth,this.stageH=Layout.getInstance().stage.stageHeight;var t=RES.getRes("bg_jpg");this.textureHeight=t.textureHeight,this.rowCount=Math.ceil(this.stageH/this.textureHeight)+1,this.bmpArr=[];for(var n=0;n<this.rowCount;n++){var i=utils.createBitmapByName("bg_jpg");i.y=this.textureHeight*n-(this.textureHeight*this.rowCount-this.stageH),i.width=this.stageW,this.bmpArr.push(i),this.addChild(i)}},t.prototype.start=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)},t.prototype.enterFrameHandler=function(e){for(var t=0;t<this.rowCount;t++){var n=this.bmpArr[t];n.y+=this.speed,n.y>this.stageH&&(n.y=this.bmpArr[0].y-this.textureHeight,this.bmpArr.pop(),this.bmpArr.unshift(n))}},t.prototype.pause=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)},t}(egret.DisplayObjectContainer);e.BgMap=t,__reflect(t.prototype,"fighter.BgMap")}(fighter||(fighter={}));var fighter;!function(e){var t=function(t){function n(e,n){var i=t.call(this,e)||this;return i.textureName=n,i}return __extends(n,t),n.produce=function(t){null==e.Bullet.cacheDict[t]&&(e.Bullet.cacheDict[t]=[]);var n,i=e.Bullet.cacheDict[t];return n=i.length>0?i.pop():new e.Bullet(RES.getRes(t),t)},n.reclaim=function(t){var n=t.textureName;null==e.Bullet.cacheDict[n]&&(e.Bullet.cacheDict[n]=[]);var i=e.Bullet.cacheDict[n];-1==i.indexOf(t)&&i.push(t)},n.cacheDict={},n}(egret.Bitmap);e.Bullet=t,__reflect(t.prototype,"fighter.Bullet")}(fighter||(fighter={}));var fighter;!function(e){var t=component.BaseView,n=function(t){function n(){var e=t.call(this)||this;return e.myBullets=[],e.enemyFighters=[],e.enemyFightersTimer=new egret.Timer(1e3),e.enemyBullets=[],e.myScore=0,e.timerCount=0,e.fullScreen=!0,e._lastTime=egret.getTimer(),e}return __extends(n,t),n.prototype.show=function(){t.prototype.show.call(this),this.stageW=Layout.getInstance().stage.stageWidth,this.stageH=Layout.getInstance().stage.stageHeight,this.map=new e.BgMap,this.addChild(this.map),this.btnStart=utils.createBitmapByName("btn_start_png"),this.btnStart.x=(this.stageW-this.btnStart.width)/2,this.btnStart.y=(this.stageH-this.btnStart.height)/2,this.btnStart.touchEnabled=!0,this.btnStart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gameStart,this),this.addChild(this.btnStart),this.myFighter=new e.Airplane(RES.getRes("f1_png"),100,"f1_png"),this.myFighter.y=this.stageH-this.myFighter.height-50,this.addChild(this.myFighter),this.scorePanel=new e.ScorePanel,this.preCreatedInstance()},n.prototype.preCreatedInstance=function(){var t=0,n=[];for(t=0;20>t;t++){var i=e.Bullet.produce("b1_png");n.push(i)}for(t=0;20>t;t++)i=n.pop(),e.Bullet.reclaim(i);for(t=0;20>t;t++){var i=e.Bullet.produce("b2_png");n.push(i)}for(t=0;20>t;t++)i=n.pop(),e.Bullet.reclaim(i);for(t=0;20>t;t++){var r=e.Airplane.produce("f2_png",1e3);n.push(r)}for(t=0;20>t;t++)r=n.pop(),e.Airplane.reclaim(r)},n.prototype.gameStart=function(){var e=this;this.myScore=0,this.timerCount=0,this.removeChild(this.btnStart),this.map.start(),this.touchEnabled=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.myFighter.x=(this.stageW-this.myFighter.width)/2,SoundManager.getIns().play("readygo_mp3"),egret.setTimeout(function(){e.myFighter.fire()},this,2e3),this.myFighter.blood=GameConfig.myPlaneBlood,this.myFighter.addEventListener("createBullet",this.createBulletHandler,this),this.enemyFightersTimer.delay=1e3,this.enemyFightersTimer.addEventListener(egret.TimerEvent.TIMER,this.createEnemyFighter,this),this.enemyFightersTimer.start(),this.scorePanel.parent==this&&this.removeChild(this.scorePanel)},n.prototype.touchHandler=function(e){if(e.type==egret.TouchEvent.TOUCH_MOVE){var t=e.localX;t=Math.max(0,t),t=Math.min(this.stageW-this.myFighter.width,t),this.myFighter.x=t}},n.prototype.createBulletHandler=function(t){var n;if(t.target==this.myFighter)for(var i=0;2>i;i++)n=e.Bullet.produce("b1_png"),n.x=0==i?this.myFighter.x+30:this.myFighter.x+this.myFighter.width-72,n.y=this.myFighter.y-50,this.addChildAt(n,this.numChildren-1-this.enemyFighters.length),this.myBullets.push(n);else{var r=t.target;n=e.Bullet.produce("b2_png"),n.x=r.x+28,n.y=r.y+10,this.addChildAt(n,this.numChildren-1-this.enemyFighters.length),this.enemyBullets.push(n)}},n.prototype.createEnemyFighter=function(e){this.timerCount++,this.timerCount>=20&&(this.timerCount=0,this.enemyFightersTimer.delay>100&&(this.enemyFightersTimer.delay=this.enemyFightersTimer.delay-100,console.log("this.enemyFightersTimer.delay:"+this.enemyFightersTimer.delay))),this.realCreate()},n.prototype.realCreate=function(){var t=e.Airplane.produce("f2_png",1e3);t.x=Math.random()*(this.stageW-t.width),t.y=-t.height-300*Math.random(),t.addEventListener("createBullet",this.createBulletHandler,this),t.fire(),this.addChildAt(t,this.numChildren-1),this.enemyFighters.push(t)},n.prototype.gameViewUpdate=function(t){var n=egret.getTimer(),i=1e3/(n-this._lastTime);this._lastTime=n;for(var r,s=60/i,o=0,a=this.myBullets.length;a>o;o++)r=this.myBullets[o],r.y<-r.height&&(this.removeChild(r),e.Bullet.reclaim(r),this.myBullets.splice(o,1),o--,a--),r.y-=GameConfig.myBulletSpeed*s;var h,l=this.enemyFighters.length;for(o=0;l>o;o++)h=this.enemyFighters[o],h.y>this.stage.stageHeight&&(this.removeChild(h),e.Airplane.reclaim(h),h.removeEventListener("createBullet",this.createBulletHandler,this),h.stopFire(),this.enemyFighters.splice(o,1),o--,l--),h.y+=4*s;var c=this.enemyBullets.length;for(o=0;c>o;o++)r=this.enemyBullets[o],r.y>this.stage.stageHeight&&(this.removeChild(r),e.Bullet.reclaim(r),this.enemyBullets.splice(o,1),o--,c--),r.y+=GameConfig.enemyBulletSpeed*s;this.gameHitTest()},n.prototype.gameHitTest=function(){var t,n,i,r,s=this.myBullets.length,o=this.enemyFighters.length,a=this.enemyBullets.length,h=[],l=[];for(t=0;s>t;t++)for(i=this.myBullets[t],n=0;o>n;n++)r=this.enemyFighters[n],utils.GameUtil.hitTest(r,i)&&(r.blood-=GameConfig.myBulletHurt,-1==h.indexOf(i)&&h.push(i),r.blood<=0&&-1==l.indexOf(r)&&(SoundManager.getIns().play("bomb_mp3"),l.push(r)));for(t=0;a>t;t++)i=this.enemyBullets[t],utils.GameUtil.hitTest(this.myFighter,i)&&(this.myFighter.blood-=GameConfig.enemyBulletHurt,-1==h.indexOf(i)&&h.push(i));for(t=0;o>t;t++)r=this.enemyFighters[t],utils.GameUtil.hitTest(this.myFighter,r)&&(this.myFighter.blood-=GameConfig.hitHurt);if(this.myFighter.blood<=0)this.gameStop();else{for(;h.length>0;)i=h.pop(),this.removeChild(i),"b1_png"==i.textureName?this.myBullets.splice(this.myBullets.indexOf(i),1):this.enemyBullets.splice(this.enemyBullets.indexOf(i),1),e.Bullet.reclaim(i);for(this.myScore+=l.length;l.length>0;)r=l.pop(),r.stopFire(),r.removeEventListener("createBullet",this.createBulletHandler,this),this.removeChild(r),this.enemyFighters.splice(this.enemyFighters.indexOf(r),1),e.Airplane.reclaim(r)}},n.prototype.gameStop=function(){this.addChild(this.btnStart),this.map.pause(),this.removeEventListener(egret.Event.ENTER_FRAME,this.gameViewUpdate,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchHandler,this),this.myFighter.stopFire(),this.myFighter.removeEventListener("createBullet",this.createBulletHandler,this),this.enemyFightersTimer.removeEventListener(egret.TimerEvent.TIMER,this.createEnemyFighter,this),this.enemyFightersTimer.stop();for(var t;this.myBullets.length>0;)t=this.myBullets.pop(),this.removeChild(t),e.Bullet.reclaim(t);for(;this.enemyBullets.length>0;)t=this.enemyBullets.pop(),this.removeChild(t),e.Bullet.reclaim(t);for(var n;this.enemyFighters.length>0;)n=this.enemyFighters.pop(),n.stopFire(),n.removeEventListener("createBullet",this.createBulletHandler,this),this.removeChild(n),e.Airplane.reclaim(n);this.scorePanel.showScore(this.myScore),this.scorePanel.x=(this.stageW-this.scorePanel.width)/2,this.scorePanel.y=100,this.addChild(this.scorePanel)},n}(t);e.GameContainer=n,__reflect(n.prototype,"fighter.GameContainer")}(fighter||(fighter={}));var DrangonBoneUtil=function(){function e(){}return e.createIdelDrangonBone=function(e){void 0===e&&(e="F_zhanshen20");var t=RES.getRes(e+"_ske_json"),n=RES.getRes(e+"_tex_json"),i=RES.getRes(e+"_tex_png"),r=dragonBones.EgretFactory.factory;r.parseDragonBonesData(t),r.parseTextureAtlasData(n,i);var s=r.buildArmatureDisplay(e);return s.animation.play("idle"),s},e}();__reflect(DrangonBoneUtil.prototype,"DrangonBoneUtil");var utils;!function(e){function t(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t}var n=function(){function e(){}return e.hitTest=function(t,n){var i,r,s=1;
return s=t instanceof fighter.Bullet?1:.6,i=e.createSelfBound(t,s),s=n instanceof fighter.Airplane?.6:1,r=e.createSelfBound(n,s),i.intersects(r)},e.createSelfBound=function(e,t){void 0===t&&(t=1);var n=e.width*t,i=e.height*t,r=(e.width-e.width*t)/2+e.x,s=(e.height-e.height*t)/2+e.y;return new egret.Rectangle(r,s,n,i)},e}();e.GameUtil=n,__reflect(n.prototype,"utils.GameUtil"),e.createBitmapByName=t}(utils||(utils={}));var fighter;!function(e){var t=function(e){function t(){var t=e.call(this)||this,n=t.graphics;return n.beginFill(0,.8),n.drawRect(0,0,400,200),n.endFill(),t.txt=new egret.TextField,t.txt.width=400,t.txt.height=200,t.txt.textAlign="center",t.txt.textColor=16777215,t.txt.size=24,t.txt.y=60,t.addChild(t.txt),t.touchChildren=!1,t.touchEnabled=!1,t}return __extends(t,e),t.prototype.showScore=function(e){var t="您的成绩是:\n"+e+"\n再来一次吧";this.txt.text=t},t}(egret.Sprite);e.ScorePanel=t,__reflect(t.prototype,"fighter.ScorePanel")}(fighter||(fighter={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?i(r):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Views;!function(e){var t=Manager.ModuleManager,n=Events.CommonEvent,i=Manager.EventManager,r=Model.GlobalData,s=proxy.HttpCommand,o=proxy.PlayerInfoProxy,a=Manager.Layout,h=utils.ViewUtil,l=component.BaseView,c=function(l){function c(){var e=l.call(this)||this;return e.fullScreen=!0,e.skinName="resource/eui_skins/GameEndSkin.exml",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onshow,e),e}return __extends(c,l),c.prototype.childrenCreated=function(){l.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.addChildAt(h.getShape(a.getInstance().stage.stageWidth,a.getInstance().stage.stageHeight,0,.5),0)},c.prototype.onshow=function(){return r.isInAPP||(o.getInstance().getMyInfo(),r.isInAPP)?(this.notIngameText.visible=!1,i.addEventListener(n.UP_SOCRE_SUCESS,this.onUpSocre,this),void s.getInstance().reportResult(r.userID,r.score)):(this.myscore.text=""+r.score,this.topScore.text="",this.initEvent(),void(this.notIngameText.visible=!0))},c.prototype.initEvent=function(){this.restartBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.allRank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRank,this)},c.prototype.onUpSocre=function(e){this.initEvent(),console.log("开始请求"),i.removeEventListener(n.UP_SOCRE_SUCESS,this.onUpSocre,this),i.addEventListener(n.GET_USERRANK_SUCESS,this.onGetUserRank,this),s.getInstance().getUserRank(r.userID)},c.prototype.onGetUserRank=function(t){var s=t.data,o=s[0],a=[];s.prevMember&&s.prevMember.userid&&a.push(s.prevMember),s[0]&&(s[0].self=!0,a.push(s[0])),s.nextMember&&s.nextMember.userid&&a.push(s.nextMember),this.myscore.text=""+r.score,this.topScore.text="历史最高分："+o.userScore;for(var h=0;h<a.length;h++){var l=a[h],c=new e.EndRankItem(l);this.subGroup.addChild(c),c.x=196*h}i.removeEventListener(n.GET_USERRANK_SUCESS,this.onGetUserRank,this)},c.prototype.onRestart=function(e){this.onClose(null)},c.prototype.onClose=function(e){t.getInstance().destroyForInstance(this)},c.prototype.onRank=function(e){t.getInstance().openModule("RankListView")},c.prototype.hide=function(){i.removeEventListener(n.UP_SOCRE_SUCESS,this.onUpSocre,this),i.removeEventListener(n.GET_USERRANK_SUCESS,this.onGetUserRank,this),this.restartBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.restartBtn=null,this.closeBtn=null,this.allRank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRank,this),this.allRank=null,l.prototype.hide.call(this)},c}(l);e.GameEndView=c,__reflect(c.prototype,"Views.GameEndView")}(Views||(Views={}));var Views;!function(e){var t=component.BaseView,n=config.GameConfig,i=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/GameInfo.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.desc.text=n.gameIntro,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onClose=function(t){e.prototype.hide.call(this)},t}(t);e.GameInfoView=i,__reflect(i.prototype,"Views.GameInfoView")}(Views||(Views={}));var Views;!function(e){var t=component.BaseView,n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/UninAppNotic.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.gameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.linkBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLink,this)},t.prototype.onClose=function(t){e.prototype.hide.call(this)},t.prototype.onLink=function(e){window.open("http://hnly.chinashadt.com:8010/syncott/Modile/Detailed/download/index.html")},t}(t);e.GameInfoVGameNoInAppViewiew=n,__reflect(n.prototype,"Views.GameInfoVGameNoInAppViewiew")}(Views||(Views={}));var Views;!function(e){var t=component.BaseView,n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/RewardsSkin.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.verticalCenter=this.horizontalCenter=0,this.desc.text="    周榜第一名，可获得价值五百元的新年大礼包一份，奖品由浏阳广播电视台提供。\n				周榜第二名，可获得价值三百元的新年礼包一份，奖品由千城智联（上海）网络科技有限公司提供。 \n				周榜第三名，可获得价值一百元的新年奖券一份，奖品由浏阳食品公司提供。\n				\n				通关用户将有机会获得最高一千元现金红包奖励。\n				周榜奖励会在每周日的20:00进行统计，获奖用户可凭借帐号排名，前往浏阳广播电视台进行兑换。\n				本活动排名以“掌上浏阳”客户端排位为准。\n				本次活动最终解释权归浏阳广播电视台所有。",this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},t.prototype.onClose=function(t){e.prototype.hide.call(this)},t}(t);e.GameRewardsView=n,__reflect(n.prototype,"Views.GameRewardsView")}(Views||(Views={}));var Views;!function(e){var t=component.BaseView,n=Model.GlobalData,i=Manager.ModuleManager,r=function(e){function t(){var t=e.call(this)||this;return t.fullScreen=!0,t.addBlackBg=!1,t.skinName="resource/eui_skins/GameStartSkin.exml",t}return __extends(t,e),t.prototype.show=function(){e.prototype.show.call(this),n.isInAPP||i.getInstance().openModule("GameInfoVGameNoInAppViewiew"),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this)},t.prototype.onRestart=function(e){n.score=0,i.getInstance().destroyForInstance(this),i.getInstance().openModule("GameLogic")},t}(t);e.GameStartView=r,__reflect(r.prototype,"Views.GameStartView")}(Views||(Views={}));var Views;!function(e){var t=utils.StringUtil,n=function(e){function n(t){var n=e.call(this)||this;return n.data=t,n.skinName="resource/eui_skins/EndRankItemSkin.exml",n}return __extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.init()},n.prototype.init=function(){var e=!!this.data.self;this.nameText.text=t.getChar(this.data.userName,18),this.rank.textColor=e?3766780:14540254,this.bg.visible=e,this.userPic.source=""+this.data.userPic,this.rank.text=""+this.data.userNumber1,this.score.text=""+this.data.userScore},n}(eui.Component);e.EndRankItem=n,__reflect(n.prototype,"Views.EndRankItem")}(Views||(Views={}));var Views;!function(e){var t=Model.RankData,n=function(e){function n(){var t=e.call(this)||this;return t.initX=0,t.initY=0,t.skinName="resource/skins/RankPanel.exml",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onshow,t),t}return __extends(n,e),n.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.width=Layout.getInstance().stage.stageWidth,this.height=Layout.getInstance().stage.stageHeight},n.prototype.onChange=function(e){"tabBtn2Skin"==e.currentTarget.skinName?this.curType=2:this.curType=1,this.changeRank()},n.prototype.onshow=function(){EventManager.addEventListener(Events.CommonEvent.GET_RANK_SUCESS,this.renderData,this),this.curType=1,this.changeRank(),this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBack,this),this.mylist.itemRenderer=i,this.nationBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.localBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.end,this)},n.prototype.detroy=function(){EventManager.removeEventListener(Events.CommonEvent.GET_RANK_SUCESS,this.renderData,this),this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBack,this),this.nationBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.localBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChange,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.end,this)},n.prototype.begin=function(e){this.initX=e.stageX,this.initY=e.stageY},n.prototype.end=function(e){(e.stageX-this.initX>200||e.stageX-this.initX<-200)&&(this.mylist.dataProvider=null,this.curType=1==this.curType?2:1,this.changeRank())},n.prototype.onBack=function(e){ModuleManager.getInstance().destroyForInstance(this)},n.prototype.changeRank=function(){this.scroller&&this.scroller.stopAnimation(),this.mylist&&(this.mylist.scrollV=0),1==this.curType?(this.localBtn.currentState="up",this.nationBtn.currentState="down",this.touchChildren=this.touchEnabled=!1,HttpCommand.getInstance().getRankList(this.curType)):(this.localBtn.currentState="down",this.nationBtn.currentState="up",this.touchChildren=this.touchEnabled=!1,HttpCommand.getInstance().getRankList(this.curType))},n.prototype.renderData=function(e){if(void 0===e&&(e=null),this.touchChildren=this.touchEnabled=!0,!e||parseInt(e.data)==this.curType){var n;n=1==this.curType?t.getInstance().localSortList:t.getInstance().nationSortList,this.mylist.dataProvider=new eui.ArrayCollection(n),this.mylist.scrollV=0}},n}(component.BaseView);e.RankListView=n,__reflect(n.prototype,"Views.RankListView");var i=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/RankListItem.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.scaleX=Layout.getInstance().scaleX},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.data.userName=utils.StringUtil.getChar(this.data.userName,18),this.itemIndex<3?(this.scoreTxt.textColor=16711680,this.currentState="order",this.orderPic.source=RES.getRes("order"+(this.itemIndex+1)+"_png")):(this.currentState="nomorl",this.order.text=""+(this.itemIndex+1),this.scoreTxt.textColor=3355443),this.userPic.source=""+this.data.userPic},t}(eui.ItemRenderer);e.RankListItemRenderer=i,__reflect(i.prototype,"Views.RankListItemRenderer")}(Views||(Views={}));